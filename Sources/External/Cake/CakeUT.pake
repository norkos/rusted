append $sources DependencyInjection/UnitTests/DependencyInjectionTest.cpp
append $sources Serialization/UnitTests/TmsTest.cpp
append $sources Serialization/UnitTests/FcTest.cpp
append $sources Networking/Protocol/UnitTests/ProtocolTest.cpp
append $sources Utils/UnitTests/StringListTest.cpp
append $sources mainUT.cpp

append $libraries Cake
append $libraries gtest
append $libraries pthread
append $libraries $__configuration.socket_libraries

set $generated_dir "${__build}/generated.CakeUT/"

append $include_dirs ./
append $include_dirs ../
append $include_dirs $boost.__path
append $include_dirs $gtest.__path
append $include_dirs $generated_dir

target application CakeUT sources($sources) link_with($libraries) include_dirs($include_dirs) depends_on(Cake gtest SampleProtocolHeader)

set $protoc "Networking/Protocol/protoc.py"
set $sample_protocol_hpp "${generated_dir}/SampleProtocol.hpp"
set $sample_protocol_xml Networking/Protocol/UnitTests/SampleProtocol.xml
set $protoc_command "mkdir -p ${generated_dir} && ${protoc} --output ${sample_protocol_hpp} ${sample_protocol_xml} --namespace Cake::Networking::Protocol"

target phony SampleProtocolHeader run_before($protoc_command) prerequisites($sample_protocol_xml $protoc) artefacts($sample_protocol_hpp)

